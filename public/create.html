<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create QR Code - QR Code Manager</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <div style="display: flex; align-items: center; gap: 1rem;">
      <a href="/dashboard" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 1rem;">
        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary-emerald), var(--primary-emerald-dark)); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; color: white; font-weight: var(--font-bold);">QR</div>
        <h1 style="font-size: var(--text-2xl);" id="page-title">Create QR Code</h1>
      </a>
    </div>

    <div style="display: flex; align-items: center; gap: 1rem;">
      <a href="/dashboard" class="btn btn-secondary btn-sm">
        <i data-lucide="arrow-left" style="width: 16px; height: 16px;"></i>
        Back to Dashboard
      </a>
    </div>
  </div>

  <div style="display: flex; min-height: calc(100vh - 73px);">
    <!-- Form Section -->
    <div style="flex: 1; padding: var(--space-2xl); max-width: 800px; margin: 0 auto; width: 100%;">
      <!-- Alert Container -->
      <div id="alert-container"></div>

      <form id="qr-form">
        <!-- Basic Info Section -->
        <div class="card" style="margin-bottom: var(--space-xl);">
          <h3 style="margin-bottom: var(--space-lg);">Basic Information</h3>

          <div class="form-group">
            <label class="form-label" for="qr-name">QR Code Name *</label>
            <input
              type="text"
              id="qr-name"
              class="input-field"
              placeholder="e.g., My Website, Contact Card"
              required
            >
          </div>

          <div class="form-group">
            <label class="form-label" for="qr-type">Type *</label>
            <select id="qr-type" class="input-field" required>
              <option value="url">URL / Website</option>
              <option value="text">Plain Text</option>
              <option value="vcard">vCard (Contact)</option>
              <option value="wifi">WiFi Network</option>
              <option value="email">Email</option>
              <option value="sms">SMS Message</option>
              <option value="phone">Phone Number</option>
            </select>
          </div>

          <!-- Dynamic Content Fields -->
          <div id="content-fields"></div>

          <div class="form-group">
            <label class="form-label" for="qr-notes">Notes (optional)</label>
            <textarea
              id="qr-notes"
              class="input-field"
              placeholder="Add any notes about this QR code..."
              rows="3"
            ></textarea>
          </div>
        </div>

        <!-- Organization Section -->
        <div class="card" style="margin-bottom: var(--space-xl);">
          <h3 style="margin-bottom: var(--space-lg);">Organization</h3>

          <div class="form-group">
            <label class="form-label" for="qr-tags">Tags</label>
            <input
              type="text"
              id="qr-tags"
              class="input-field"
              placeholder="Separate tags with commas: work, marketing, personal"
            >
            <p class="form-helper">Add tags to help organize and find your QR codes</p>
          </div>

          <div class="form-group">
            <label class="form-label" for="qr-folder">Folder</label>
            <input
              type="text"
              id="qr-folder"
              class="input-field"
              placeholder="e.g., Client Work, Personal Projects"
            >
          </div>

          <div class="form-group">
            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
              <input type="checkbox" id="qr-favorite">
              <span class="form-label" style="margin: 0;">
                <i data-lucide="star" style="width: 14px; height: 14px; display: inline;"></i>
                Mark as Favorite
              </span>
            </label>
          </div>

          <!-- All QR codes are now dynamic - show short URL -->
          <div class="form-group" id="short-url-display">
            <label class="form-label">
              <i data-lucide="link" style="width: 14px; height: 14px; display: inline;"></i>
              Short URL (permanent link in QR code)
            </label>
            <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(245, 158, 11, 0.05)); padding: var(--space-md); border-radius: var(--radius-md); border: 1px solid rgba(16, 185, 129, 0.2);">
              <div style="font-family: monospace; font-size: var(--text-sm); color: var(--primary-emerald); word-break: break-all;">
                <span id="short-url-value">Generating...</span>
              </div>
            </div>
            <p class="form-helper">âœ“ All QR codes are dynamic. The QR contains this short URL. You can change where it redirects anytime!</p>
          </div>
        </div>

        <!-- Customization Section -->
        <div class="card" style="margin-bottom: var(--space-xl);">
          <h3 style="margin-bottom: var(--space-lg);">Customization</h3>

          <div class="form-group">
            <label class="form-label">Colors</label>
            <div style="display: flex; gap: var(--space-lg);">
              <div style="flex: 1;">
                <label class="form-label" for="qr-color-dark" style="font-size: var(--text-xs);">Foreground</label>
                <div style="display: flex; gap: var(--space-sm); align-items: center;">
                  <input type="color" id="qr-color-dark" class="color-input" value="#000000">
                  <input type="text" class="input-field" id="qr-color-dark-text" value="#000000" style="flex: 1;">
                </div>
              </div>
              <div style="flex: 1;">
                <label class="form-label" for="qr-color-light" style="font-size: var(--text-xs);">Background</label>
                <div style="display: flex; gap: var(--space-sm); align-items: center;">
                  <input type="color" id="qr-color-light" class="color-input" value="#ffffff">
                  <input type="text" class="input-field" id="qr-color-light-text" value="#ffffff" style="flex: 1;">
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="qr-size">
              Size: <span id="size-value">300</span>px
            </label>
            <input
              type="range"
              id="qr-size"
              min="100"
              max="1000"
              step="50"
              value="300"
              style="width: 100%;"
            >
          </div>

          <div class="form-group">
            <label class="form-label" for="qr-error-correction">Error Correction</label>
            <select id="qr-error-correction" class="input-field">
              <option value="L">Low (7%)</option>
              <option value="M" selected>Medium (15%)</option>
              <option value="Q">Quartile (25%)</option>
              <option value="H">High (30%)</option>
            </select>
            <p class="form-helper">Higher levels allow the QR code to be read even if damaged</p>
          </div>
        </div>

        <!-- Form Actions -->
        <div style="display: flex; gap: var(--space-md); flex-wrap: wrap;">
          <button type="submit" class="btn btn-primary btn-lg" id="save-btn">
            <i data-lucide="save" style="width: 18px; height: 18px;"></i>
            <span id="save-text">Create QR Code</span>
          </button>
          <a href="/dashboard" class="btn btn-secondary btn-lg">
            Cancel
          </a>
        </div>
      </form>
    </div>

    <!-- Preview Section -->
    <div style="width: 400px; background: var(--bg-primary); border-left: 1px solid var(--border-color); padding: var(--space-2xl); position: sticky; top: 73px; height: calc(100vh - 73px); overflow-y: auto;">
      <h3 style="margin-bottom: var(--space-lg);">Live Preview</h3>

      <div class="preview-box" id="preview-container">
        <p style="color: var(--text-tertiary);">Fill in the form to see preview</p>
      </div>

      <div style="margin-top: var(--space-lg);">
        <button class="btn btn-secondary" style="width: 100%;" id="generate-preview-btn">
          <i data-lucide="eye" style="width: 18px; height: 18px;"></i>
          Generate Preview
        </button>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <!-- QRCode.js Library - Load before qr-create.js -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/lib/browser.js"></script>
  <script src="/js/qr-create.js"></script>
  <script>
    // Initialize Lucide icons
    lucide.createIcons();
  </script>
</body>
</html>
